

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>8.5. Reordering and Matrix Bandwidth &#8212; Linear Multistep Methods</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"N": "\\mathbb{N}", "Z": "\\mathbb{Z}", "R": "\\mathbb{R}", "C": "\\mathbb{C}", "D": "\\mathrm{D}", "E": "\\mathrm{E}", "S": "\\mathrm{S}", "dy": "\\mathrm{d}y", "dx": "\\mathrm{d}x", "ds": "\\mathrm{d}s", "dt": "\\mathrm{d}t", "i": "\\mathbf{\\hat{i}}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chaps/08/chap08_5_reordering';</script>
    <link rel="shortcut icon" href="../../_static/ode.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="8.6. Chapter 8 Exercises" href="chap08_6_exercise.html" />
    <link rel="prev" title="8.4. Sparse Matrices Storage and Reordering" href="chap08_4_storage.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Tuesday 02 January 2024 00:03:55 GMT"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Linear Multistep Methods - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Linear Multistep Methods - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../overview/motivation.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/schedule.html">Teaching Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/assessments.html">Assessments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/readingList.html">Further Reading List</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Prerequisite</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00/chap00_B_symbols.html">Symbols and Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00/chap00_B_biexpan.html">Binomial Expansion</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../00/chap00_A0_DE.html">Differential Equations</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../00/chap00_A1_definition.html">Definitions, Classification and Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../00/chap00_A2_ode.html">Ordinary Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../00/chap00_A3_analytical.html">Analytical Methods for ODEs</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture Notes and Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01/chap01_0.html">1. Complex Numbers and Difference Equations</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../01/chap01_1_complexNumber.html">1.1. Complex Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/chap01_2_sequence.html">1.2. Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/chap01_3_differenceEquation.html">1.3. Difference Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/chap01_4_homogenous.html">1.4. Homogeneous Linear Difference Equations with Constant Coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/chap01_5_exercise.html">1.5. Chapter 1 Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../02/chap02_0.html">2. Interpolating Polynomial</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../02/chap02_1_introduction.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/chap02_2_differenceOperator.html">2.2. Finite Difference Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/chap02_3_interpolation.html">2.3. Gregory-Newton Interpolation Formulae</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/chap02_4_differenceTable.html">2.4. Finite Difference Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/chap02_5_exercise.html">2.5. Chapter 2 Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03/chap03_0.html">3. Multistep Methods: Derivation by Finite Difference formulae</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03/chap03_1_multistepMethod.html">3.1. Multistep Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/chap03_2_derivation.html">3.2. Derivation of Multistep Methods by Numerical Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/chap03_3_explicit.html">3.3. Explicit  Multistep Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/chap03_4_implicit.html">3.4. Implicit  Multistep Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/chap03_5_predictorCorrector.html">3.5. Predictor-Corrector Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/chap03_6_codes.html">3.6. Example Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/chap03_7_exercise.html">3.7. Chapter 3 Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04/chap04_0.html">4. Multistep Methods: Order and Error Constants</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../04/chap04_1_errorIntegration.html">4.1. Derivation of Local Error Terms for Integration Formulae</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/chap04_2_errorConstant.html">4.2. Order and Error Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/chap04_3_MilineDevice.html">4.3. Estimate of truncation error at each step for Predictor-Corrector methods – Milne’s Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/chap04_4_exercise.html">4.4. Chapter 4 Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../05/chap05_0.html">5. Multistep Methods: Stability I</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../05/chap05_1_rootCondition.html">5.1. Characteristic Polynomials and Root Condition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/chap05_2_convergence.html">5.2. Zero-Stability, Consistency and Convergence Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/chap05_3_exercise.html">5.3. Chapter 5 Exercise</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../06/chap06_0.html">6. Multistep Methods: Stability II</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../06/chap06_1_stabilityInterval.html">6.1. Interval and Region of Absolute Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/chap06_2_rootLocus.html">6.2. The Root Locus Method for Finding the Interval of Absolute Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/chap06_3_boundaryRootLocus.html">6.3. The Boundary Root Locus Method for Finding Regions of Absolute Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/chap06_4_exampleCode.html">6.4. Example MATLAB Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/chap06_5_exercise.html">6.5. Chapter 6 Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../07/chap07_0.html">7. Stiff Differential Equations</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../07/chap07_1_introduction.html">7.1. Introduction and background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/chap07_2_stiffSystem.html">7.2. Stiff Systems of Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/chap07_3_method.html">7.3. Methods for Stiff Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/chap07_4_codeExample.html">7.4. MATLAB Program 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/chap07_5_exercise.html">7.5. Chapter 7 Exercise</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="chap08_0.html">8. Sparse Matrices</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="chap08_1_introduction.html">8.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="chap08_2_sparseMatrix.html">8.2. Sparse Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="chap08_3_graphTheory.html">8.3. Matrix Sparsity and Graph Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="chap08_4_storage.html">8.4. Sparse Matrices Storage and Reordering</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">8.5. Reordering and Matrix Bandwidth</a></li>
<li class="toctree-l2"><a class="reference internal" href="chap08_6_exercise.html">8.6. Chapter 8 Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="chap08_7_answers.html">8.7. Answers to Chapter 8 Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference external" href="https://uk.mathworks.com/help/matlab/ordinary-differential-equations.html">ODE Solvers in Matlab</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html">ODE Solvers in Scipy</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chaps/08/chap08_5_reordering.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Reordering and Matrix Bandwidth</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cuthill-and-mckee-reordering">8.5.1. Cuthill and McKee Reordering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#column-count-reordering">8.5.2. Column Count Reordering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimum-degree-reordering">8.5.3. Minimum Degree Reordering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-between-various-ordering-schemes-and-fill-in-effect">8.5.4. Comparison between various ordering schemes and fill-in effect</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="reordering-and-matrix-bandwidth">
<h1><span class="section-number">8.5. </span>Reordering and Matrix Bandwidth<a class="headerlink" href="#reordering-and-matrix-bandwidth" title="Permalink to this heading">#</a></h1>
<p>During the process of matrix factorization into a product by methods
such as Gaussian elimination and Cholesky factorization, there will
always be a problem with fill-in that is generating additional nonzero
elements during the elimination process (i.e. row operation). Hence we
are unable to take advantage of the sparsity feature of the original
matrix and end up wasting both storage and computational time. Therefore
the problem is how to perform row operations whilst minimizing the
fill-in of nonzero elements. One way to achieve this is to try to
position the nonzero elements near the main or principal diagonal, so
that reordering of rows and columns will not result in additional
nonzero elements. The process of moving the nonzero element near the
principal diagonal is the same as reducing the profile or the bandwidth
of the matrix.</p>
<p>Consider an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix <span class="math notranslate nohighlight">\(A=(a_{ij})\)</span>. If all matrix elements are
zero outside a diagonally confined band whose range is determined by
constants <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>;</p>
<p><span class="math notranslate nohighlight">\(a_{ij}=0\)</span> <span class="math notranslate nohighlight">\(\text{if}\)</span> <span class="math notranslate nohighlight">\(j&lt;i-p\)</span> <span class="math notranslate nohighlight">\(\text{or}\)</span> <span class="math notranslate nohighlight">\(j&gt;i+q\)</span>; <span class="math notranslate nohighlight">\(p,q \geq 0\)</span></p>
<p>(or <span class="math notranslate nohighlight">\(j-i&gt;p\)</span>, or <span class="math notranslate nohighlight">\(i-j&gt;q\)</span>; <span class="math notranslate nohighlight">\(p, q \geq 0\)</span> ),</p>
<p>where <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are the
distances above and below the main diagonal, then the bandwidth <span class="math notranslate nohighlight">\(bw\)</span> is
given by <span class="math notranslate nohighlight">\(bw=p+q+1\)</span> (in other words, it is the smallest number of
adjacent diagonals to which the non-zero elements are confined).</p>
<p>A
matrix is called a band matrix or banded matrix if its bandwidth is
reasonably small.</p>
<p>A band matrix with <span class="math notranslate nohighlight">\(p=q=0\)</span> is a diagonal matrix;</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A=\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0  \\
0 &amp; 1 &amp; 0 &amp; 0  \\
0 &amp; 0 &amp; 1 &amp; 0  \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
\end{split}\]</div>
<p>A band matrix with <span class="math notranslate nohighlight">\(p=q=1\)</span> is a tridiagonal matrix;</p>
<div class="math notranslate nohighlight">
\[\begin{split}
B=
\begin{bmatrix}
1 &amp; 1 &amp; 0 &amp; 0  \\
1 &amp; 1 &amp; 1 &amp; 0  \\
0 &amp; 1 &amp; 1 &amp; 1  \\
0 &amp; 0 &amp; 1 &amp; 1
\end{bmatrix}
\end{split}\]</div>
<p>The indices of the nonzero elements for matrix <span class="math notranslate nohighlight">\(B\)</span> are
given in the following table, using the conventional numbering used in
MATLAB.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(i\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(j\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\([i, j]\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>[1, 1]</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1</p></td>
<td><p>[2, 1]</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>2</p></td>
<td><p>[1, 2]</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>2</p></td>
<td><p>[2, 2]</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>2</p></td>
<td><p>[3, 2]</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>3</p></td>
<td><p>[2, 3]</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>3</p></td>
<td><p>[3, 3]</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>3</p></td>
<td><p>[4, 3]</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>4</p></td>
<td><p>[3, 4]</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>4</p></td>
<td><p>[4, 4]</p></td>
</tr>
</tbody>
</table>
<p>Therefore, the difference between i and j for each nonzero entry is
either 0 or 1; hence the maximum distance is 1, i.e. in MATLAB the
bandwidth calculation for a tridiagonal matrix <span class="math notranslate nohighlight">\(T\)</span> is performed by the
following commands:-</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% Calculate bandwidth of a given matrix

&gt;&gt; T =[
     1     1     0     0
     1     1     1     0
     0     1     1     1
     0     0     1     1]

&gt;&gt; [i,j]=find(T);
&gt;&gt; bw=max(i-j)

bw =
     1
</pre></div>
</div>
<p>Note:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[i,j]=find(T); %returns the row and column indices for
               % the nonzero entries
bw=max(i-j)    %returns an array the same size as i
               %and j with the largest elements taken
               %from i or j.
               %the dimensions of i and j must match.
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note - in some textbooks and articles the bandwidth is given as
<span class="math notranslate nohighlight">\(bw=p+q+1\)</span> - the bandwidth of a tridiagonal matrix is given as 3 (i.e.
<span class="math notranslate nohighlight">\(1(L) + 1(U) + 1(D)\)</span>). Also, when <span class="math notranslate nohighlight">\(p=q=2\)</span> one has a pentadiagonal matrix
and so on. Also, an upper triangular matrix is obtained when <span class="math notranslate nohighlight">\(q=0\)</span>,
<span class="math notranslate nohighlight">\(q=n-1\)</span>, and similarly, with <span class="math notranslate nohighlight">\(p=n-1\)</span>, <span class="math notranslate nohighlight">\(q=0\)</span>, a lower triangular matrix
is obtained.</p>
</div>
<div class="section" id="cuthill-and-mckee-reordering">
<h2><span class="section-number">8.5.1. </span>Cuthill and McKee Reordering<a class="headerlink" href="#cuthill-and-mckee-reordering" title="Permalink to this heading">#</a></h2>
<p>The most simple and popular method of minimizing the bandwidth was
developed by Cuthill and McKee (1969). Later the method was improved by
Alan George who developed the <span class="target" id="index-0"></span>Reverse Cuthill and McKee (RCM) method
which is much more effective than the original CM algorithm. There are
several other efficient bandwidth reduction methods used in re-ordering
of sparse matrices, namely Minimum Degree Reordering method. The Cuthill
and McKee algorithm is outlined in the following steps:-</p>
<ol class="arabic simple">
<li><p>For a given sparse symmetric matrix, plot the adjacency graph
(alternatively if you have been given the adjacency graph, then it
is useful to write down the corresponding adjacency matrix).</p></li>
<li><p>Look at all the nodes, and produce a table listing the node numbers
and the number of connections (or degree).</p></li>
<li><p>Select the node with the lowest degree (say <span class="math notranslate nohighlight">\(n_1\)</span>) and write it down
under a column heading ‘Result/Head’. If there is more than one node
with the same number of degree, then choose one of them and write it
down.</p></li>
<li><p>Look at the nodes connected directly to node <span class="math notranslate nohighlight">\(n_1\)</span>, write down in
the next column ‘Queue’ the nodes that are connected to <span class="math notranslate nohighlight">\(n_1\)</span>, in
the order with lowest degree (e.g. <span class="math notranslate nohighlight">\(n_2\)</span>, <span class="math notranslate nohighlight">\(n_3\)</span>, <span class="math notranslate nohighlight">\(n_4\)</span>) that has not
appeared in the Result column before.</p></li>
<li><p>Extract the first node in the queue - say <span class="math notranslate nohighlight">\(n_2\)</span>, if <span class="math notranslate nohighlight">\(n_2\)</span> has not
been previously inserted in ‘Result’ then write <span class="math notranslate nohighlight">\(n_2\)</span> below <span class="math notranslate nohighlight">\(n_1\)</span>
and check again for the connections. Since <span class="math notranslate nohighlight">\(n_4\)</span> is already in the
queue, you need to see if <span class="math notranslate nohighlight">\(n_2\)</span> is connected to any other nodes, say
<span class="math notranslate nohighlight">\(n_5\)</span> write down in the queue column <span class="math notranslate nohighlight">\(n_4\)</span> if <span class="math notranslate nohighlight">\(n_2\)</span> was not
connected to a new node, just leave a blank in the queue column.</p></li>
<li><p>Now, write down <span class="math notranslate nohighlight">\(n_3\)</span> below <span class="math notranslate nohighlight">\(n_2\)</span> in the Results column, and repeat
step 4.</p></li>
<li><p>Repeat steps 4 to 6 until there are no more nodes left to be
considered.</p></li>
<li><p>Look at your list in the column Result - and renumber these as new
node numbers.</p></li>
<li><p>Continue until the size of the array Result is <span class="math notranslate nohighlight">\(n\)</span> for an
<span class="math notranslate nohighlight">\(n\times n\)</span> matrix (i.e. all nodes are included in the array).</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note:- If the selected node in column Results is not connected to any
other node, then we put a ‘-‘ in the corresponding position in the queue
column.</p>
</div>
<div class="proof example admonition" id="ch08-example-rcm">
<p class="admonition-title"><span class="caption-number">Example 8.7 </span></p>
<div class="example-content section" id="proof-content">
<p>Consider the following sparse matrix and
its corresponding adjacency plot:</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column docutils">
<p>Matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A=
      \begin{bmatrix}
        1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
        0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
        0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
        0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
        1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
        0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
        0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
        0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1
      \end{bmatrix}
\end{split}\]</div>
</div>
<div class="sd-col sd-d-flex-column docutils">
<p>Graph</p>
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-c9c970a5f35bebf064d1e865b245392da367372b.svg" alt="Figure made with TikZ" /></p>
</div></div>
</div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Original nodes</p></th>
<th class="head"><p>No. of connections</p></th>
<th class="head"><p>Results Head</p></th>
<th class="head"><p>Queue</p></th>
<th class="head"><p>RCM</p></th>
<th class="head"><p>New nodes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>5</p></td>
<td><p>7</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>3</p></td>
<td><p>4</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>8</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>6,8</p></td>
<td><p>6</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>2</p></td>
<td><p>6</p></td>
<td><p>-</p></td>
<td><p>2</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>2</p></td>
<td><p>8</p></td>
<td><p>-</p></td>
<td><p>3</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>1</p></td>
<td><p>4</p></td>
<td><p>7</p></td>
<td><p>5</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>2</p></td>
<td><p>7</p></td>
<td><p>-</p></td>
<td><p>1</p></td>
<td><p>8</p></td>
</tr>
</tbody>
</table>
<p>Note that the labels of new nodes are the reverse of the elements in the
array Results. See below the re-ordered matrix and the adjacency graph
(note the diagram remains unchanged, but nodes are now relabelled).</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column docutils">
<div class="math notranslate nohighlight">
\[\begin{split}
B=
        \begin{bmatrix}
          1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
          1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
          0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
          0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 \\
          0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1
        \end{bmatrix}
\end{split}\]</div>
</div>
<div class="sd-col sd-d-flex-column docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-42115cd37bd1aae255efa352c022147eb3f2a7b9.svg" alt="Figure made with TikZ" /></p>
</div></div>
</div>
</div>
<p>It can be seen that the algorithm keeps all nonzero elements close to
the diagonal. You can see visibly that there are more zero elements
below and above the main diagonal and nonzero elements are close to the
main diagonal and the re-ordered matrix exhibits a banded structure.</p>
<p>Using MATLAB the bandwidths of the original matrix A and the reordered
matrix B can be found as:-</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="nb">i</span><span class="p">,</span><span class="nb">j</span><span class="p">]=</span><span class="nb">find</span><span class="p">(</span><span class="n">A</span><span class="p">);</span><span class="w"> </span><span class="c">%returns the row and col indices</span>
<span class="w">                  </span><span class="c">%of the nonzero entries</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">bw</span><span class="p">=</span><span class="nb">max</span><span class="p">(</span><span class="nb">i</span><span class="o">-</span><span class="nb">j</span><span class="p">)</span>
<span class="n">bw</span><span class="w"> </span><span class="p">=</span><span class="mi">6</span>

<span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="nb">i</span><span class="p">,</span><span class="nb">j</span><span class="p">]=</span><span class="nb">find</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">bw</span><span class="p">=</span><span class="nb">max</span><span class="p">(</span><span class="nb">i</span><span class="o">-</span><span class="nb">j</span><span class="p">)</span>
<span class="n">bw</span><span class="w"> </span><span class="p">=</span><span class="mi">2</span>
</pre></div>
</div>
<p>i.e. The (half) bandwidth of the matrix has been reduced to 2 instead of
6; hence, the full bandwidth of the matrices A and B are 13 and 5
respectively.</p>
<p>Note that the relabeling described above used the reverse
of the array RCM of the reordered nodes, hence this is the Reverse
Cuthill-McKee (RCM) re-ordering technique. In the original Cuthill-McKee
(CM) algorithm, the elements of array Results are relabelled without
reversing the elements. i.e.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Original nodes</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cuthill-McKee</p></td>
<td><p>1</p></td>
<td><p>5</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>6</p></td>
<td><p>8</p></td>
<td><p>4</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-odd"><td><p>Reverse CM</p></td>
<td><p>7</p></td>
<td><p>4</p></td>
<td><p>8</p></td>
<td><p>6</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>In MATLAB, the command <code class="docutils literal notranslate"><span class="pre">symrcm(A)</span></code> returns the symmetric reverse
Cuthill-McKee ordering of A. This is a permutation matrix p such that
<span class="math notranslate nohighlight">\(A(p,p)\)</span> tends to have its nonzero elements closer to the main diagonal.
Example MATLAB code:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">symrcm</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="nb">spy</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">)),</span><span class="w"> </span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;A(p,p) after Cuthill-McKee ordering&#39;</span><span class="p">)</span>
<span class="n">nz</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">nnz</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="n">pct</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="o">/</span><span class="nb">numel</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s">&#39;nonzeros=%d (%.1f%%)&#39;</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="n">nz</span><span class="o">*</span><span class="n">pct</span><span class="p">));</span>
</pre></div>
</div>
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-6111af12eefea9175535e9984c46518b60cb7cb4.svg" alt="Figure made with TikZ" /></p>
</div><p>Figure 5 below shows the nonzero pattern of the original matrix A, the
ordered matrix B, matrix C, ordered by the CM method, and matrix D is
found by using the MATLAB function <code class="docutils literal notranslate"><span class="pre">symrcm</span></code></p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-713df8cca1ce93f95f50d1c95f8a3d4abf3ba47f.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-83ff1d9a6455dc6a0f1c2851df8b427b1ec52491.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-cf7fc766a86317718f788928fea4cc0c71da7c0a.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-9418f92b1523d57ede712cc7f639afc00601cdc4.svg" alt="Figure made with TikZ" /></p>
</div></div>
</div>
</div>
<p>Note that the half bandwidth of the reordered matrix <span class="math notranslate nohighlight">\(C\)</span>, using the
original Cuthill-Mckee method is <span class="math notranslate nohighlight">\(bw =5\)</span>, and the half bandwidth of the
reordered matrix <span class="math notranslate nohighlight">\(D\)</span> is <span class="math notranslate nohighlight">\(bw =2\)</span>, using the MATLAB function <code class="docutils literal notranslate"><span class="pre">sysmrcm</span></code> for
the reverse Cuthill-Mckee is <span class="math notranslate nohighlight">\(bw =2\)</span>, i.e. the same as that for matrix
<span class="math notranslate nohighlight">\(B\)</span>. Hence, the Reverse Cuthill-Mckee algorithm for bandwidth reduction
of sparse matrices seems to be the most effective reordering method.</p>
</div>
</div></div>
<div class="section" id="column-count-reordering">
<h2><span class="section-number">8.5.2. </span>Column Count Reordering<a class="headerlink" href="#column-count-reordering" title="Permalink to this heading">#</a></h2>
<p>The idea of the <span class="target" id="index-1"></span>column count reordering algorithm is to move rows and
columns with higher nonzero count towards the end of the matrix. This
algorithm reduces the time and storage for computing matrix operations
such as the LU factorization and the Cholesky factorization, but its
performance is not consistent overall and depends on the original
matrix.</p>
<div class="proof example admonition" id="ch08-example-columncount">
<p class="admonition-title"><span class="caption-number">Example 8.8 </span></p>
<div class="example-content section" id="proof-content">
<p>Consider the sparse matrix and its
corresponding adjacency graph from
<a class="reference internal" href="#ch08-example-rcm">Example 8.7</a> :</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column docutils">
<div class="math notranslate nohighlight">
\[\begin{split}A=
        \begin{bmatrix}
          1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
          0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
          1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
          0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
          0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1
        \end{bmatrix}
\end{split}\]</div>
</div>
<div class="sd-col sd-d-flex-column docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-2eab16d0894046785ee23b6689d2c345ce652696.svg" alt="Figure made with TikZ" /></p>
</div></div>
</div>
</div>
<p>The degrees of all vertices are obtained in the following:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>vertex</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>no. of degree</p></td>
<td><p>1</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<p>Since vertex 7 has the least degrees, it is labelled as 1 - (Note: since
vertices 1, 4, and 7 have the same number of degrees, therefore the new
labels are interchangeable, as any of these vertices can be chosen in
any order) and then vertices 4 and 1 are labelled (again since vertices
4 and 1 have the same number of degrees, therefore the new labels are
interchangeable). The algorithm is then continued in the same steps
until complete labelling is obtained as shown:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>new vertex</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>old vertex</p></td>
<td><p>7</p></td>
<td><p>4</p></td>
<td><p>1</p></td>
<td><p>8</p></td>
<td><p>6</p></td>
<td><p>5</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<p>The resulting adjacency matrix and graph are shown below:</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column docutils">
<div class="math notranslate nohighlight">
\[\begin{split}CC=
        \begin{bmatrix}
          1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
          1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
          0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 \\
          0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 \\
          0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 \\
          0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 \\
          0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 1
        \end{bmatrix}\end{split}\]</div>
</div>
<div class="sd-col sd-d-flex-column docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-787b539b7889cdf9bddf82b828e63018ecd560dd.svg" alt="Figure made with TikZ" /></p>
</div></div>
</div>
</div>
<p>Similar to the command <code class="docutils literal notranslate"><span class="pre">symrcm</span></code> for RCM reordering, in MATLAB the
command <code class="docutils literal notranslate"><span class="pre">colperm</span></code> returns the column count reordering of <span class="math notranslate nohighlight">\(A\)</span>. This
is a permutation matrix <span class="math notranslate nohighlight">\(q\)</span> such that <span class="math notranslate nohighlight">\(A(q,q)\)</span> tends to move rows and
columns with higher nonzero count towards the end of the matrix (a
down-arrow effect).</p>
<p>Example MATLAB code:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">colperm</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="nb">spy</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">q</span><span class="p">)),</span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;A(q,q)-Column Count ordering by colperm&#39;</span><span class="p">)</span>
<span class="n">nz</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">nnz</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="n">pct</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">numel</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s">&#39;nonzeros=%d (%.1f%%)&#39;</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="n">nz</span><span class="o">*</span><span class="n">pct</span><span class="p">));</span>
</pre></div>
</div>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-651ebe8bdeb057cee327d68f5c6b15da2e61ee24.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-a5e3aea9f9f0033a13984ef33e1065aadce09e45.svg" alt="Figure made with TikZ" /></p>
</div></div>
</div>
</div>
<!-- <figure>
<div class="center">
<table>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="main/07/cc_comb_1.tikz"
style="width:40.0%" alt="image" /></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><img src="main/07/cc_comb_2.tikz"
style="width:40.0%" alt="image" /></td>
</tr>
</tbody>
</table>
</div>
</figure> -->
</div>
</div></div>
<div class="section" id="minimum-degree-reordering">
<h2><span class="section-number">8.5.3. </span>Minimum Degree Reordering<a class="headerlink" href="#minimum-degree-reordering" title="Permalink to this heading">#</a></h2>
<p>The <span class="target" id="index-2"></span>minimum degree algorithm attempts to reduce the fill-in caused by
elimination such as Gaussian elimination, LU decomposition or the
Cholesky decomposition. The computational costs of this algorithm is
inexpensive, and it is easy to apply and effective for most problems
which are not too large. However, most mathematical software packages
such as MATLAB use an approximation minimum degree, rather than the
exact degree to minimise the computational costs. The minimum degree
algorithm is re-labelling of the vertices in ascending degree order.
Nodes with lower degrees are labelled early to reduce adding many
fill-ins.</p>
<div class="proof example admonition" id="ch08-example-mindegree">
<p class="admonition-title"><span class="caption-number">Example 8.9 </span></p>
<div class="example-content section" id="proof-content">
<p>Consider the sparse matrix and its
corresponding adjacency graph from <a class="reference internal" href="#ch08-example-rcm">Example 8.7</a>:</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column docutils">
<div class="math notranslate nohighlight">
\[\begin{split}A=
        \begin{bmatrix}
          1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
          0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
          1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
          0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
          0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1
       \end{bmatrix}\end{split}\]</div>
</div>
<div class="sd-col sd-d-flex-column docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-2eab16d0894046785ee23b6689d2c345ce652696.svg" alt="Figure made with TikZ" /></p>
</div></div>
</div>
</div>
<p>The minimum degree algorithm is re-labelling of the vertices in
ascending degree order. Nodes with lower degrees are labelled early to
reduce adding many fill-ins.</p>
<p>The degrees of all vertices are shown in the following table:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>vertex</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>no. of degree</p></td>
<td><p>1</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<p>where vertex 7 has the least degrees, then vertex 7 is numbered with
first as 1. Since vertex 7 is connected to vertex 4, then vertex 4 must
be updated by subtracting 1 (if it is already 1 then just write it down
as 1 and number it immediately after 7) as shown in the following
Table - where the eliminated node is represented by X , and the vertex
is numbered with a new label. Note: if no tie-breaking strategy has been
established, all three vertices 1, 4, and 7 can be selected in this
case, and proceed to elimination. The completed ordering using the
Minimum Degree algorithm is shown in the following table, together with
the resulting adjacency matrix and graph:</p>
<a class="reference internal image-reference" href="../../_images/minDegree.svg"><img alt="../../_images/minDegree.svg" class="align-center" src="../../_images/minDegree.svg" width="500px" /></a>
<!-- ::: center  
                    |    vertex and no. of degree                     
                    |  1   2   3   4   5   6   7   8
       New ordering |  1   3   2   1   2   2   1   2
  ---------------------------------------------------    
   1      (7)       |  1   3   2   1   2   2   X   2
   2      (4)       |  1   3   2   X   2   2   X   2
   3      (1)       |  X   3   2   X   1   2   X   2
   4      (5)       |  X   3   1   X   X   2   X   2
   5      (3)       |  X   2   X   X   X   2   X   2
   6      (6)       |  X   1   X   X   X   X   X   1
   7      (8)       |  X   1   X   X   X   X   X   X
   8      (2)       |  X   X   X   X   X   X   X   X
::: -->
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column docutils">
<div class="math notranslate nohighlight">
\[\begin{split}MD=
        \begin{bmatrix}
          1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
          1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
          0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 \\
          0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 \\
          0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 \\
          0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 1
        \end{bmatrix}\end{split}\]</div>
</div>
<div class="sd-col sd-d-flex-column docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-24fb31a4adb303b29896b786ef0475f491531831.svg" alt="Figure made with TikZ" /></p>
</div></div>
</div>
</div>
<p>Similar to the commands <code class="docutils literal notranslate"><span class="pre">symrcm</span></code> and <code class="docutils literal notranslate"><span class="pre">colperm</span></code>, in MATLAB
the command <code class="docutils literal notranslate"><span class="pre">symamd</span></code> returns the approximate Minimum Degree
reordering of <span class="math notranslate nohighlight">\(A\)</span> to produce large blocks of zeros in the matrix. The
permutation matrix <span class="math notranslate nohighlight">\(r\)</span> is calculated such that <span class="math notranslate nohighlight">\(A(r,r)\)</span> tends to move rows
and columns with higher nonzero elements towards the end of the matrix -
similar to the Column Count algorithm.</p>
<p>Example MATLAB code:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">symamd</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="nb">spy</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">r</span><span class="p">)),</span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;A(r,r)-Minimum Degree ordering by symamd&#39;</span><span class="p">)</span>
<span class="n">nz</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">nnz</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="n">pct</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">numel</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s">&#39;nonzeros=%d (%.1f%%)&#39;</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="n">nz</span><span class="o">*</span><span class="n">pct</span><span class="p">));</span>
</pre></div>
</div>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-4b43bc24433dd889a46bb397faddb776172cc129.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-a370f46cf3fa9934497cd765c50e86facb9be27a.svg" alt="Figure made with TikZ" /></p>
</div></div>
</div>
</div>
</div>
</div></div>
<div class="section" id="comparison-between-various-ordering-schemes-and-fill-in-effect">
<span id="chap08-reorder-comparsion"></span><h2><span class="section-number">8.5.4. </span>Comparison between various ordering schemes and fill-in effect<a class="headerlink" href="#comparison-between-various-ordering-schemes-and-fill-in-effect" title="Permalink to this heading">#</a></h2>
<p>For a more effective comparison we consider a symmetric <span class="math notranslate nohighlight">\(20 \times 20\)</span>
sparse matrix A, which was generated by using MATLAB’s <strong>rand</strong> command:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sparse</span><span class="p">(</span><span class="o">+</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">));</span><span class="w"> </span><span class="c">% should allow &lt;10% nonzeros</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">=</span><span class="nb">full</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">=</span><span class="n">B</span><span class="o">&#39;*</span><span class="n">B</span><span class="w">  </span><span class="c">% makes A a symmetric matrix</span>
</pre></div>
</div>
<p>Using the MATLAB *<em>spy</em> command the corresponding sparsity
patterns from the results of the reordering by the RCM, CC and MD
methods are summarised in Figure 6. Furthermore, using the MATLAB
command <span class="math notranslate nohighlight">\([L,U] = lu(A)\)</span> the upper triangular matrix in <span class="math notranslate nohighlight">\(U\)</span> for the full
matrix A and the reordered matrices are also shown in Figure 6. [ Note:
for the original matrix <span class="math notranslate nohighlight">\(bw =18\)</span> and for the RCM reordered matrix
<span class="math notranslate nohighlight">\(bw =7\)</span> were found using MATLAB]</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-961aca406d2df38553c9dba22a5e539b898771cb.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-be8a54a002c5c7ff5fbed413e75429d950add1b0.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-de20332985e4ce71aa6a6c852aedf7ba131dbf86.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-703630afc392ee56370b7463284179e40cb83980.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-94414e0515194f2d582a5bcc901c95f9a5e488dc.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-9782ae7ebadc1d74060eba24a06ab71f67870d21.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-9b906dde14aeb9c3a8be0b67a5ee9686d888615f.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-c0621e8a57e90e83b775ee7e94a3b68107e78831.svg" alt="Figure made with TikZ" /></p>
</div></div>
<p>Figure 6. Comparison between reordering schemes for a <span class="math notranslate nohighlight">\(20 \times 20\)</span> symmetric matrix</p>
</div>
</div>
<p>In summary, the re-ordering or permutation of matrices provides a
pre-conditioning for the solution of matrices and the resulting matrix
is already nearly in LU factorization or banded form depending on the
chosen ordering method. Applying methods for the solution of full
matrices will produce more nonzero elements (fill-in effect) and no
computational advantage from the sparsity of matrix can be achieved.</p>
<p>For the <span class="math notranslate nohighlight">\(20 \times 20\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> the number of fill-in required to form the
upper triangular using LU factorization of the permuted matrix is shown
in the following table:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-center head"><p><span class="math notranslate nohighlight">\(20 \times 20\)</span></p></th>
<th class="text-center head"><p>Original Matrix</p></th>
<th class="text-center head"><p>Reverse CM</p></th>
<th class="text-center head"><p>Column Count</p></th>
<th class="text-center head"><p>Min Degree</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>No. of nnz in <span class="math notranslate nohighlight">\(\mathbf{U}\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(66\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(54\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(53\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(58\)</span></p></td>
</tr>
</tbody>
</table>
<p>For large matrices with a high percentage of zero elements, reordering
process of matrices significantly reduces the number of fill-in and the
CPU processing time , as well as the amount of memory required for data
storage when solving large sparse linear system of equations.</p>
<p>For a <span class="math notranslate nohighlight">\(3000\times 3000\)</span> matrix as an example the effect of reordering on the
LU factors are presented in the following table:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(3000 \times 3000\)</span></p></th>
<th class="head"><p>nnz (percentage)</p></th>
<th class="head"><p>CPU (sec)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Original Matrix</p></td>
<td><p><span class="math notranslate nohighlight">\(1783708\)</span>        <span class="math notranslate nohighlight">\((100)\%\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(5.500\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Reverse CM</p></td>
<td><p><span class="math notranslate nohighlight">\(862448\)</span>         <span class="math notranslate nohighlight">\((48)\%\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1.438\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Column Count</p></td>
<td><p><span class="math notranslate nohighlight">\(521582\)</span>         <span class="math notranslate nohighlight">\((29)\%\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1.016\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Minimum Degree</p></td>
<td><p><span class="math notranslate nohighlight">\(692034\)</span>         <span class="math notranslate nohighlight">\((39)\%\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1.047\)</span></p></td>
</tr>
</tbody>
</table>
<div class="proof example admonition" id="ch08-example-comparison">
<p class="admonition-title"><span class="caption-number">Example 8.10 </span></p>
<div class="example-content section" id="proof-content">
<p>Consider the following sparse matrix and
its corresponding adjacency graph.</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="math notranslate nohighlight">
\[\begin{split}A=
          \begin{bmatrix}
        1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\
        1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
        0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\
        0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
        0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
        0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
        1 &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
        1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
      \end{bmatrix}\end{split}\]</div>
</div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-b7f8f9d3b05612433872e7c15bf779d9b9bc1c09.svg" alt="Figure made with TikZ" /></p>
</div></div>
</div>
</div>
<p>For the RCM and Column Count reordering methods, use the MATLAB commands
<code class="docutils literal notranslate"><span class="pre">symrcm(A)</span></code> and <code class="docutils literal notranslate"><span class="pre">colperm(A)</span></code> to find the corresponding reordered
matrices <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(D\)</span>. Plot the pattern of matrices <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(D\)</span>.
Apply the MATLAB command <code class="docutils literal notranslate"><span class="pre">[L,U]=lu(A)</span></code> for finding the LU factorisation
of matrices <span class="math notranslate nohighlight">\(A\)</span>, and similarly <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(D\)</span>. Plot the pattern of the
resulting matrices using <code class="docutils literal notranslate"><span class="pre">spy(lu(A))</span></code>, <code class="docutils literal notranslate"><span class="pre">spy(lu(C))</span></code> and <code class="docutils literal notranslate"><span class="pre">spy(lu(D))</span></code>.
Comment on the number of non-zero elements following LU factorisation.
Plot the upper triangular matrix U for each of the factorised matrices
and record the number of non-zero (nz) elements in U for each of the
resulting upper triangular matrices in a table. Comment on the
advantages of the LU factorisation and the effect of fill-in when using
ordered matrices. The three stages of the required solution together
with the MATLAB commands are summerised in Figure 7.</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-b69c57e40ec7c147aded2518bf717a73de76d64d.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-25350b405f99468ffa4a3140e25fc23e7bd6073d.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-53824ecba7e308f1bb5212bbe0f364ab0de0476a.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-4cc699d69c475340368aee5438ff5deca4212173.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-c777cd5da65657120f4afa51c17e70d59515aa19.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-9cbbff5bb995a3502a3bd5f758c93606abd2ac6e.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-2f84f6be81188fda65fae56494a94ef141ceaf11.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-3530748538a4371f3a970d326b865b6c90e28692.svg" alt="Figure made with TikZ" /></p>
</div></div>
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 docutils">
<div class="figure" style="text-align: center"><p><img  src="../../_images/tikz-aed90c3fd1e595a2c66d43a27b6751a3bc0eb750.svg" alt="Figure made with TikZ" /></p>
</div></div>
</div>
</div>
<p>Figure 7. Comparison of the LU factorisation and fill-in effect on
original and ordered matrices.</p></p>
<p>Following LU factorisation, we find the number of non-zero elements in
various reordering methods in <span class="math notranslate nohighlight">\(U\)</span> as:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(8 \times 8\)</span></p></th>
<th class="head"><p>Original Matrix</p></th>
<th class="head"><p>Reverse CM</p></th>
<th class="head"><p>Column Count</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>No. of nnz in <span class="math notranslate nohighlight">\(\mathbf{U}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(24\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(17\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(18\)</span></p></td>
</tr>
</tbody>
</table>
<p>Hence, using the re-ordering methods, both RCM and Column Count,
significantly reduces the generation of fill-in elements compared to the
LU factorisation of the original matrix <span class="math notranslate nohighlight">\(A\)</span>, even for an <span class="math notranslate nohighlight">\(8\times8\)</span>
matrix.</p>
<p>Furthermore, the solution to the original linear algebraic system
contributes significantly to the total computational time for the
solution of stiff problems, as well as affecting the accuracy of the
solution (and hence, affecting the computational time). Note that
re-ordering enhances the computational accuracy through a reduction in
rounding errors (due to fewer computational steps, resulting from
reduced fill-in elements). In terms of application in the solutions of
large systems of stiff differential equations (which require treatment
of the associated Jacobinan metrix), the re-ordering of the system of
equations resulting from the Newton iteration will lead to the solution
of a banded matrix instead of a full matrix treatment, and hence
resulting in fewer fill-ins, more accurate solutions and shorter
computing time.</p>
</div>
</div><p><strong>References</strong></p>
<p>MATLAB Help/documentation on Sparse Matrices, e.g.:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.mathworks.co.uk/help/matlab/math/accessing-sparse-matrices.html">http://www.mathworks.co.uk/help/matlab/math/accessing-sparse-matrices.html</a></p></li>
<li><p><a class="reference external" href="http://www.mathworks.co.uk/help/matlab/examples/sparse-matrices.html">http://www.mathworks.co.uk/help/matlab/examples/sparse-matrices.html</a></p></li>
<li><p>Saad, Y., 2003. Iterative Methods for Sparse Linear System 2nd ed. Philadelphia:    SIAM- Society for Industrial and Applied Mathematics</p></li>
<li><p>Golub, G. and Van Loan, C., 1996g. Matrix Computations 3rd edition. London: The Johns Hopkins University Press</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chaps/08"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chap08_4_storage.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">8.4. </span>Sparse Matrices Storage and Reordering</p>
      </div>
    </a>
    <a class="right-next"
       href="chap08_6_exercise.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8.6. </span>Chapter 8 Exercises</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cuthill-and-mckee-reordering">8.5.1. Cuthill and McKee Reordering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#column-count-reordering">8.5.2. Column Count Reordering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimum-degree-reordering">8.5.3. Minimum Degree Reordering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-between-various-ordering-schemes-and-fill-in-effect">8.5.4. Comparison between various ordering schemes and fill-in effect</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By <a href='mailto:z.ma@mmu.ac.uk'>Dr Zhihua Ma</a>
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023---2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Tuesday 02 January 2024 00:03:55 GMT.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>